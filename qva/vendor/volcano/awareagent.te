# Copyright (c) 2024-2025 Qualcomm Innovation Center, Inc. All rights reserved.
# # SPDX-License-Identifier: BSD-3-Clause-Clear
#
type vendor_awareagent, domain;
type vendor_awareagent_exec, exec_type, vendor_file_type, file_type;

# Allow for transition from init domain to vendor_hal_awareagent_qti
init_daemon_domain(vendor_awareagent)

#============= vendor_awareagent ==============
allow vendor_awareagent proc_meminfo:file { r_file_perms };
allow vendor_awareagent proc_stat:file { r_file_perms };
allow vendor_awareagent sysfs_net:dir { r_dir_perms };
allow vendor_awareagent sysfs_net:file { r_file_perms };

get_prop(vendor_awareagent, wifi_hal_prop);

allow vendor_awareagent vendor_sysfs_battery_supply:dir search;
allow vendor_awareagent vendor_sysfs_battery_supply:file { read open };

allow vendor_awareagent vendor_aware_vndr_data_file:dir { rw_dir_perms };
allow vendor_awareagent vendor_aware_vndr_data_file:file { create_file_perms };

allow vendor_awareagent vendor_persist_aware_file:dir create_dir_perms;
allow vendor_awareagent vendor_persist_aware_file:file create_file_perms;
allow vendor_awareagent mnt_vendor_file:dir search;
neverallow {domain -init -vendor_init -vendor_awareagent -vendor_hal_provisioningmanager_qti -vendor_hal_datamanager_qti} vendor_persist_aware_file:{dir file} *;

set_prop(vendor_awareagent, vendor_awareagent_prop);
get_prop(vendor_awareagent, boot_status_prop)

binder_call(vendor_awareagent, servicemanager)

hal_client_domain(vendor_awareagent, vendor_hal_provisioningmanager)
hal_client_domain(vendor_awareagent, vendor_hal_datamanager)

allow vendor_awareagent proc_uptime:file { open read };
